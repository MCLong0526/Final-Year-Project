import{be as h,r as o,d as i,j as s}from"./main-DSQZSxUQ.js";const _=h("user",()=>{const t=o({username:null,email:null,roles:[],token:localStorage.getItem("token")||null,avatar:null,phone_number:null,user_id:null,status:null}),u=o(null),m=i(()=>!!t.value.token),l=o(null),d=i(()=>t.value.roles.some(e=>e.name==="Admin"));function c(){t.value={username:null,email:null,roles:[],token:null,avatar:null,phone_number:null,user_id:null,status:null},u.value=null}async function p(e,r){try{const a=await s.post("/api/auth/authenticate",{email:e,password:r}),n=a.data.user;return t.value={username:n.username,email:n.email,roles:n.roles,avatar:n.avatar,phone_number:n.phone_number,user_id:n.user_id,status:n.status,token:a.data.token},localStorage.setItem("token",a.data.token),[a.data,null]}catch(a){return l.value=a.response.data.error,[null,a]}}async function g(){try{await s.post("/api/auth/logout"),localStorage.removeItem("token"),c()}catch(e){console.error(e)}}async function v(){try{const r=(await s.get("/api/auth/get-user")).data.data;t.value={...r,token:t.value.token}}catch(e){console.error(e)}}return{user:t,deviceToken:u,$reset:c,login:p,isLoggedIn:m,logout:g,getCurrentLoggedUser:v,errorMessages:l,isAdmin:d}});export{_ as u};
