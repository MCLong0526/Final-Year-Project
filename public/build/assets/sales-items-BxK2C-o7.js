import{_ as xe}from"./UserProfileDialog-DWAxYQ98.js";import{_ as ce,r as v,o as _,f as I,e as S,w as a,l as t,c as e,V as d,A as r,F as L,h as K,t as m,x as F,n as ge,z as j,j as ue,k as pe,q as p,I as P,U as $e,B as X,S as _e,d as be,O as Ve,G as Se,a9 as fe}from"./main-BSPiQKaW.js";import{d as O,b as re,V as De,a as ke}from"./VChip-BYk0Rox1.js";import{c as J,d as ne,f as Z,b as Q,V as W,a as C,e as Oe,g as Ce}from"./VCard-BxV7e3yy.js";import{V as Y}from"./VImg-NVS--HvR.js";import{V as ie}from"./VTooltip-U_OY2avl.js";import{V as ee}from"./VTable-C0c7VzKA.js";import{V as me}from"./VAlert-CXDmTkgm.js";import{a as te}from"./VDialog-DBZCI81t.js";import{V as de}from"./VSnackbar-Cs2e5AEY.js";import{V as Te,r as Ie}from"./VForm-Ca2YxUua.js";import{V as we,a as Pe,b as Re}from"./VTextarea-M1ppverQ.js";import{V as ye}from"./VCombobox-DNCmzw9B.js";import{l as Me}from"./logo-1jkZqtsd.js";import{d as ze,E as Ae,u as oe,w as Ee,P as Fe}from"./xlsx-b40oiKTs.js";import{V as je}from"./VMenu-CzuKdIdc.js";import{l as Ue}from"./lodash-BYTxXjAY.js";import{V as Be,b as qe,a as he,c as ve}from"./VWindowItem-B2F0W2Eg.js";import{V as Ne}from"./VTextField-B_0z6jg2.js";import"./chat-peliAd4p.js";import"./AuthStore-BCyd-KWY.js";import"./picker-DE4OueUM.js";import"./VContainer-Cssv8K_T.js";import"./forwardRefs-T1LKPGgI.js";import"./ssrBoot-CF1ol6Ee.js";import"./VOverlay-CsdapwMi.js";import"./VCheckboxBtn-hMCho-Hd.js";import"./_commonjsHelpers-BosuxZz1.js";const M=b=>(ue("data-v-6113331c"),b=b(),pe(),b),He={class:"text-uppercase text-center"},Qe={class:"text-uppercase text-center"},Ye={class:"text-uppercase text-center"},Le={class:"text-uppercase text-center"},We={class:"text-uppercase text-center"},Ge={class:"text-uppercase text-center"},Je={class:"text-uppercase text-center"},Ke={class:"text-center"},Xe={class:"d-flex align-items-center"},Ze={style:{color:"#6c757d","font-size":"12px"}},et={class:"d-flex align-items-center"},tt={style:{color:"#6c757d","font-size":"12px"}},at={class:"text-center"},st={class:"text-center"},lt={class:"text-center"},rt={class:"text-center"},ot=M(()=>t("span",null,"View Details",-1)),nt={class:"text-uppercase text-center"},it={class:"text-uppercase text-center"},dt={class:"text-uppercase text-center"},ct={class:"text-uppercase text-center"},ut={class:"text-uppercase text-center"},pt={class:"text-uppercase text-center"},mt={class:"text-uppercase text-center"},_t={colspan:"8",class:"text-center"},ft={class:"detail-row"},ht=M(()=>t("strong",null,"Order ID",-1)),vt={class:"detail-row"},gt=M(()=>t("strong",null,"Order Date Time",-1)),yt={class:"detail-row"},xt=M(()=>t("strong",null,"Buyer",-1)),$t={class:"detail-row"},bt=M(()=>t("strong",null,"Status",-1)),Vt={key:0},St={key:1},Dt={class:"detail-row"},kt=M(()=>t("strong",null,"Item Name",-1)),Ot={class:"detail-row"},Ct=M(()=>t("strong",null,"Meet Date Time",-1)),Tt={key:0},It={key:1},wt={class:"detail-row"},Pt=M(()=>t("strong",null,"Approximated Price",-1)),Rt={key:0},Mt={key:1},zt={class:"detail-row",style:{display:"flex","align-items":"flex-start"}},At=M(()=>t("strong",null,"Place to meet",-1)),Et={style:{"white-space":"pre-line"}},Ft={class:"detail-row",style:{display:"flex","align-items":"flex-start"}},jt=M(()=>t("strong",null,"Buyer Remark",-1)),Ut={style:{"white-space":"pre-line"}},Bt={class:"detail-row",style:{display:"flex","align-items":"flex-start"}},qt=M(()=>t("strong",null,"Seller Remark",-1)),Nt={style:{"white-space":"pre-line"}},Ht={__name:"OrderItemConfirmedTable",props:{confirmedOrders:{type:Object,required:!0},getConfirmedOrders:{type:Function,required:!0}},setup(b){const f=v({}),w=v(!1),h=v(!1),g=v({}),V=v(!1),$=D=>{w.value=!0,f.value=D},k=D=>{g.value=D,V.value=!0},R=D=>{const x=new Date,i=new Date(x.getFullYear(),x.getMonth(),x.getDate());return(B=>new Date(B.split(" ")[0]))(D)<i};return(D,x)=>(_(),I(L,null,[b.confirmedOrders.length>0?(_(),S(ee,{key:0,height:"250","fixed-header":""},{default:a(()=>[t("thead",null,[t("tr",null,[t("th",He,[e(d,{icon:"ri-info-i"}),r(" Order ID ")]),t("th",Qe,[e(d,{icon:"ri-product-hunt-line"}),r(" Product ")]),t("th",Ye,[e(d,{icon:"ri-id-card-line"}),r(" Buyer ")]),t("th",Le,[e(d,{icon:"ri-calendar-schedule-line"}),r(" Order Date ")]),t("th",We,[e(d,{icon:"ri-calendar-schedule-line"}),r(" Meet Date ")]),t("th",Ge,[e(d,{icon:"ri-verified-badge-line"}),r(" Status ")]),t("th",Je,[e(d,{icon:"ri-eye-line"}),r(" View ")])])]),t("tbody",null,[(_(!0),I(L,null,K(b.confirmedOrders,i=>(_(),I("tr",{key:i.id},[t("td",Ke,[R(i.meet_dateTime)?(_(),S(O,{key:0,color:"secondary"},{default:a(()=>[r(m(i.id),1)]),_:2},1024)):(_(),S(O,{key:1,color:"primary"},{default:a(()=>[r(m(i.id),1)]),_:2},1024))]),t("td",null,[t("div",Xe,[i.item.pictures.length>0&&i.item.pictures?(_(),S(J,{key:0,size:"32",rounded:"sm",style:{"margin-inline-end":"8px"}},{default:a(()=>[e(Y,{src:i.item.pictures[0].picture_path},null,8,["src"])]),_:2},1024)):F("",!0),t("div",null,[t("div",null,m(i.item.name),1),t("div",Ze,m(i.item.type),1)])])]),t("td",null,[t("div",et,[i.user.avatar?(_(),S(J,{key:0,size:"32",color:i.user.avatar?"":"primary",class:"mr-1"},{default:a(()=>[e(Y,{src:i.user.avatar},null,8,["src"])]),_:2},1032,["color"])):F("",!0),t("div",null,[t("div",null,m(i.user.username),1),t("div",tt,m(i.user.email),1)])])]),t("td",at,m(i.order_dateTime),1),t("td",st,[i.status=="Approved"?(_(),S(O,{key:0,color:"warning",size:"x-small"},{default:a(()=>[r(m(i.meet_dateTime),1)]),_:2},1024)):(_(),S(O,{key:1,color:"warning",size:"x-small"},{default:a(()=>[r("Not Set")]),_:1}))]),t("td",lt,[t("div",{class:ge(["status-dot",{"status-dot-read":i.status==="Rejected","status-dot-read2":i.status==="Cancelled"}])},[i.status=="Approved"?(_(),S(O,{key:0,color:"success",size:"x-small"},{default:a(()=>[r(m(i.status),1)]),_:2},1024)):F("",!0),i.status=="Rejected"?(_(),S(O,{key:1,color:"error",size:"x-small"},{default:a(()=>[r(m(i.status),1)]),_:2},1024)):F("",!0),i.status=="Cancelled"?(_(),S(O,{key:2,color:"secondary",size:"x-small"},{default:a(()=>[r(m(i.status),1)]),_:2},1024)):F("",!0)],2)]),t("td",rt,[e(j,{color:"primary",style:{"margin-inline":"15px 3px"},size:"small",onClick:q=>$(i)},{default:a(()=>[e(d,{icon:"ri-list-view"}),e(ie,{"open-delay":"500",location:"top",activator:"parent",transition:"scroll-y-transition"},{default:a(()=>[ot]),_:1})]),_:2},1032,["onClick"])])]))),128))])]),_:1})):(_(),S(ee,{key:1,height:"140","fixed-header":""},{default:a(()=>[t("thead",null,[t("tr",null,[t("th",nt,[e(d,{icon:"ri-info-i"}),r(" Order ID ")]),t("th",it,[e(d,{icon:"ri-product-hunt-line"}),r(" Product ")]),t("th",dt,[e(d,{icon:"ri-id-card-line"}),r(" Buyer ")]),t("th",ct,[e(d,{icon:"ri-calendar-schedule-line"}),r(" Order Date ")]),t("th",ut,[e(d,{icon:"ri-calendar-schedule-line"}),r(" Meet Date ")]),t("th",pt,[e(d,{icon:"ri-verified-badge-line"}),r(" Status ")]),t("th",mt,[e(d,{icon:"ri-eye-line"}),r(" View ")])])]),t("tbody",null,[t("tr",null,[t("td",_t,[e(me,{variant:"tonal",type:"warning",class:"mt-2",color:"primary",closable:"",dense:""},{default:a(()=>[r(" No confirmed orders found. ")]),_:1})])])])]),_:1})),e(te,{modelValue:w.value,"onUpdate:modelValue":x[2]||(x[2]=i=>w.value=i),scrollable:"","max-width":"500"},{default:a(()=>[e(ne,null,{default:a(()=>[e(Z,{class:"mt-2 mb-1"},{default:a(()=>[r("Order Details")]),_:1}),e(re,{class:"mb-2"}),e(Q,{style:{"max-block-size":"400px","overflow-y":"auto"}},{default:a(()=>[t("div",ft,[ht,t("span",null,": #"+m(f.value.id),1)]),t("div",vt,[gt,t("span",null,": "+m(f.value.order_dateTime),1)]),t("div",yt,[xt,t("span",null,": "+m(f.value.user.username),1)]),t("div",$t,[bt,f.value.status=="Approved"?(_(),I("span",Vt,[r(": "),e(O,{color:"success",size:"small"},{default:a(()=>[e(d,{icon:"ri-check-fill",class:"mr-1"}),r(m(f.value.status),1)]),_:1})])):(_(),I("span",St,[r(": "),e(O,{color:"error",size:"small"},{default:a(()=>[e(d,{icon:"ri-close-line",class:"mr-1"}),r(m(f.value.status),1)]),_:1})]))]),e(re,{class:"mt-2 mb-2"}),t("div",Dt,[kt,t("span",null,": "+m(f.value.item.name),1)]),t("div",Ot,[Ct,f.value.status=="Approved"?(_(),I("span",Tt,[r(": "),e(O,{color:"warning",size:"small"},{default:a(()=>[e(d,{icon:"ri-check-double-fill",class:"mr-1"}),r(m(f.value.meet_dateTime),1)]),_:1})])):(_(),I("span",It,[r(": "),e(O,{color:"warning",size:"small"},{default:a(()=>[r("Not Set")]),_:1})]))]),t("div",wt,[Pt,f.value.status=="Approved"?(_(),I("span",Rt,[r(": "),e(O,{color:"warning",size:"small"},{default:a(()=>[e(d,{icon:"ri-check-double-fill",class:"mr-1"}),r(" ~ RM"+m(f.value.approximated_price),1)]),_:1})])):(_(),I("span",Mt,[r(": "),e(O,{color:"warning",size:"small"},{default:a(()=>[e(d,{icon:"ri-close-line",class:"mr-1"}),r("Not Set")]),_:1})]))]),t("div",zt,[At,t("span",Et,": "+m(f.value.place_to_meet),1)]),e(re,{class:"mt-2 mb-2"}),t("div",Ft,[jt,t("span",Ut,": "+m(f.value.remark_buyer),1)]),t("div",Bt,[qt,t("span",Nt,": "+m(f.value.remark_seller),1)])]),_:1}),e(Q,null,{default:a(()=>[e(W,null,{default:a(()=>[e(C,{cols:"12",md:"4"},{default:a(()=>[e(j,{color:"secondary",onClick:x[0]||(x[0]=i=>w.value=!1),class:"ml-2"},{default:a(()=>[e(d,{icon:"ri-close-line",class:"mr-1"}),r(" Close ")]),_:1})]),_:1}),e(C,{cols:"12",md:"4"}),e(C,{cols:"12",md:"4"},{default:a(()=>[f.value.status=="Approved"?(_(),S(j,{key:0,color:"success",onClick:x[1]||(x[1]=i=>k(f.value.user))},{default:a(()=>[e(d,{icon:"ri-whatsapp-line",class:"mr-1"}),e(ie,{location:"top",activator:"parent",transition:"scroll-x-transition"},{default:a(()=>[r(" Contact Buyer ")]),_:1}),r(" Contact ")]),_:1})):F("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(te,{modelValue:V.value,"onUpdate:modelValue":x[3]||(x[3]=i=>V.value=i),scrollable:"","max-width":"500"},{default:a(()=>[e(xe,{clickedUser:g.value},null,8,["clickedUser"])]),_:1},8,["modelValue"]),e(de,{modelValue:h.value,"onUpdate:modelValue":x[4]||(x[4]=i=>h.value=i),location:"top end",transition:"scale-transition",color:"success"},{default:a(()=>[e(d,{size:"20",class:"me-2"},{default:a(()=>[r("ri-checkbox-circle-line")]),_:1}),r(" Order has been successfully approved. ")]),_:1},8,["modelValue"])],64))}},Qt=ce(Ht,[["__scopeId","data-v-6113331c"]]),z=b=>(ue("data-v-9a9ab753"),b=b(),pe(),b),Yt={class:"text-uppercase text-center"},Lt={class:"text-uppercase text-center"},Wt={class:"text-uppercase text-center"},Gt={class:"text-uppercase text-center"},Jt={class:"text-uppercase text-center"},Kt={class:"text-uppercase text-center"},Xt={class:"text-center"},Zt={class:"d-flex align-items-center"},ea={style:{color:"#6c757d","font-size":"12px"}},ta={class:"d-flex align-items-center"},aa={style:{color:"#6c757d","font-size":"12px"}},sa={class:"text-center"},la={class:"text-center"},ra={class:"status-dot"},oa={class:"text-center"},na=z(()=>t("span",null,"Confirm Order",-1)),ia={class:"text-uppercase text-center"},da={class:"text-uppercase text-center"},ca={class:"text-uppercase text-center"},ua={class:"text-uppercase text-center"},pa={class:"text-uppercase text-center"},ma={class:"text-uppercase text-center"},_a={colspan:"6",class:"text-center"},fa=z(()=>t("h3",{class:"mt-2"},"Order Information",-1)),ha={class:"detail-row"},va=z(()=>t("strong",null,"Order at",-1)),ga={class:"detail-row"},ya=z(()=>t("strong",null,"Place to meet",-1)),xa={class:"detail-row"},$a=z(()=>t("strong",null,"Quantity",-1)),ba={class:"detail-row",style:{display:"flex","align-items":"flex-start"}},Va=z(()=>t("strong",null,"Remark",-1)),Sa={style:{"white-space":"pre-line"}},Da={class:"detail-row"},ka=z(()=>t("strong",null,"Approximated earn",-1)),Oa=z(()=>t("h3",{class:"mt-6"},"Customer Information",-1)),Ca=z(()=>t("h3",null,"Product Information",-1)),Ta=z(()=>t("label",{for:"firstNameHorizontalIcons"},"Selected Date and Time",-1)),Ia=z(()=>t("label",{for:"remarkHorizontalIcons"},"Remark",-1)),wa={__name:"OrderItemPendingTable",props:{pendingOrders:{type:Object,required:!0},getPendingOrders:{type:Function,required:!0}},emits:["update:pendingOrders"],setup(b,{emit:f}){const w=b,h=v({}),g=v(!1),V=v(!1),$=v(null),k=v(""),R=v([]),D=v(""),x=v(!1),i=v(!1),q=o=>{g.value=!0,h.value=o,N([o])},U=()=>{V.value=!0,D.value="approve"},B=()=>{V.value=!0,D.value="reject"},N=o=>(R.value=[],o.forEach(l=>{const u=l.remark_buyer.match(/(\d{4}\/\d{1,2}\/\d{1,2} \d{1,2}:\d{2} [AP]M)/g);u&&u.forEach(T=>{R.value.push(T)})}),R),n=o=>{const l=new Date(o),s=l.getFullYear(),u=String(l.getMonth()+1).padStart(2,"0"),T=String(l.getDate()).padStart(2,"0");let y=l.getHours();const A=String(l.getMinutes()).padStart(2,"0");return`${s}-${u}-${T} ${y}:${A}:00`},c=()=>{if(D.value==="approve"){if($.value===null)return;$.value=n($.value)}else if(!k.value)return;const o={meet_dateTime:$.value,remark_seller:k.value};X.put("/api/order-items/confirmed-order/"+h.value.id,o).then(l=>{V.value=!1,g.value=!1,$.value=null,k.value="",D.value==="approve"?x.value=!0:i.value=!0,D.value="",w.getPendingOrders()}).catch(l=>{console.log(l)})};return(o,l)=>(_(),I(L,null,[b.pendingOrders.length>0?(_(),S(ee,{key:0,height:"250","fixed-header":""},{default:a(()=>[t("thead",null,[t("tr",null,[t("th",Yt,[e(d,{icon:"ri-info-i"}),r(" Order ID ")]),t("th",Lt,[e(d,{icon:"ri-product-hunt-line"}),r(" Product ")]),t("th",Wt,[e(d,{icon:"ri-id-card-line"}),r(" Buyer ")]),t("th",Gt,[e(d,{icon:"ri-calendar-schedule-line"}),r(" Order Date ")]),t("th",Jt,[e(d,{icon:"ri-verified-badge-line"}),r(" Status ")]),t("th",Kt,[e(d,{icon:"ri-eye-line"}),r(" View ")])])]),t("tbody",null,[(_(!0),I(L,null,K(b.pendingOrders,s=>(_(),I("tr",{key:s.id},[t("td",Xt,[e(O,{color:"primary"},{default:a(()=>[r(m(s.id),1)]),_:2},1024)]),t("td",null,[t("div",Zt,[s.item.pictures.length>0&&s.item.pictures?(_(),S(J,{key:0,size:"32",rounded:"sm",style:{"margin-inline-end":"8px"}},{default:a(()=>[e(Y,{src:s.item.pictures[0].picture_path},null,8,["src"])]),_:2},1024)):F("",!0),t("div",null,[t("div",null,m(s.item.name),1),t("div",ea,m(s.item.type),1)])])]),t("td",null,[t("div",ta,[s.user.avatar?(_(),S(J,{key:0,size:"32",color:s.user.avatar?"":"primary",class:"mr-1"},{default:a(()=>[e(Y,{src:s.user.avatar},null,8,["src"])]),_:2},1032,["color"])):F("",!0),t("div",null,[t("div",null,m(s.user.username),1),t("div",aa,m(s.user.email),1)])])]),t("td",sa,m(s.order_dateTime),1),t("td",la,[t("div",ra,[e(O,{color:"warning"},{default:a(()=>[r(m(s.status),1)]),_:2},1024)])]),t("td",oa,[e(j,{color:"warning",style:{"margin-inline":"15px 3px"},size:"small",onClick:u=>q(s)},{default:a(()=>[e(d,{icon:"ri-eye-line"}),e(ie,{"open-delay":"500",location:"top",activator:"parent",transition:"scroll-y-transition"},{default:a(()=>[na]),_:1})]),_:2},1032,["onClick"])])]))),128))])]),_:1})):(_(),S(ee,{key:1,height:"140","fixed-header":""},{default:a(()=>[t("thead",null,[t("tr",null,[t("th",ia,[e(d,{icon:"ri-info-i"}),r(" Order ID ")]),t("th",da,[e(d,{icon:"ri-product-hunt-line"}),r(" Product ")]),t("th",ca,[e(d,{icon:"ri-id-card-line"}),r(" Buyer ")]),t("th",ua,[e(d,{icon:"ri-calendar-schedule-line"}),r(" Order Date ")]),t("th",pa,[e(d,{icon:"ri-verified-badge-line"}),r(" Status ")]),t("th",ma,[e(d,{icon:"ri-eye-line"}),r(" View ")])])]),t("tbody",null,[t("tr",null,[t("td",_a,[e(me,{variant:"tonal",type:"warning",class:"mt-2",color:"primary",closable:"",dense:""},{default:a(()=>[r(" No pending orders found. ")]),_:1})])])])]),_:1})),e(te,{modelValue:p(g),"onUpdate:modelValue":l[0]||(l[0]=s=>P(g)?g.value=s:null),scrollable:"","max-width":"800"},{default:a(()=>[e(ne,null,{default:a(()=>[e(Oe,{class:"pb-3"},{default:a(()=>[fa]),_:1}),e(Q,null,{default:a(()=>[t("div",ha,[va,t("span",null,": "+m(p(h).order_dateTime),1)]),t("div",ga,[ya,t("span",null,": "+m(p(h).place_to_meet),1)]),t("div",xa,[$a,t("span",null,": "+m(p(h).quantity),1)]),t("div",ba,[Va,t("span",Sa,": "+m(p(h).remark_buyer),1)]),t("div",Da,[ka,t("span",null,[r(": "),e(O,{color:"primary",class:"mr-2",size:"small"},{default:a(()=>[e(d,{icon:"ri-money-dollar-circle-line",class:"mr-2"}),r(" ~ RM "+m(p(h).approximated_price),1)]),_:1})])]),Oa,e(Q,{class:"font-weight-medium text-high-emphasis text-center text-truncate",style:{display:"flex","align-items":"center"}},{default:a(()=>[e(J,{size:"40",color:p(h).user.avatar?"":"primary",class:ge(`${p(h).user.avatar?"":"v-avatar-light-bg primary--text"}`),variant:p(h).user.avatar?void 0:"tonal",style:{"margin-inline-end":"8px"}},{default:a(()=>[e(Y,{src:p(h).user.avatar},null,8,["src"])]),_:1},8,["color","class","variant"]),r(" "+m(p(h).user.username),1)]),_:1}),Ca,e(we,{"delimiter-icon":"ri-circle-fill",height:"250px","hide-delimiter-background":"","show-arrows":"hover"},{default:a(()=>[(_(!0),I(L,null,K(p(h).item.pictures,(s,u)=>(_(),S(Pe,{key:u},{default:a(()=>[e(Y,{src:s.picture_path,height:"250px","object-fit":"cover",class:"mt-2 ml-2 mr-2"},null,8,["src"])]),_:2},1024))),128))]),_:1}),e(Z,null,{default:a(()=>[e(d,{icon:"ri-shopping-bag-4-line"}),r(" "+m(p(h).item.name),1)]),_:1}),e(Z,null,{default:a(()=>[e(d,{icon:"ri-money-dollar-circle-line"}),r(" RM "+m(p(h).item.price),1)]),_:1})]),_:1}),e(Q,{class:"pt-5 d-flex justify-content-center mt-4",style:{"margin-inline-start":"300px"}},{default:a(()=>[e(j,{color:"error",class:"me-4",onClick:B},{default:a(()=>[r(" Reject ")]),_:1}),e(j,{color:"success",onClick:U},{default:a(()=>[r(" Approve ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(te,{modelValue:p(V),"onUpdate:modelValue":l[6]||(l[6]=s=>P(V)?V.value=s:null),"max-width":"600"},{default:a(()=>[e(ne,{title:"Confirm Order Information"},{default:a(()=>[e(Q,null,{default:a(()=>[e(p(Te),{ref:"refForm",onSubmit:l[5]||(l[5]=$e(()=>{},["prevent"]))},{default:a(()=>[e(W,null,{default:a(()=>[p(D)==="approve"?(_(),S(C,{key:0,cols:"12"},{default:a(()=>[e(W,{"no-gutters":""},{default:a(()=>[e(C,{cols:"12",md:"3"},{default:a(()=>[Ta]),_:1}),e(C,{cols:"12",md:"9"},{default:a(()=>[e(ye,{modelValue:p($),"onUpdate:modelValue":l[1]||(l[1]=s=>P($)?$.value=s:null),items:p(R),placeholder:"Select Date from remarks buyer",label:"Select Date","prepend-inner-icon":"ri-calendar-2-line",scrollable:"",chips:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})):F("",!0),e(C,{cols:"12"},{default:a(()=>[e(W,{"no-gutters":""},{default:a(()=>[e(C,{cols:"12",md:"3"},{default:a(()=>[Ia]),_:1}),e(C,{cols:"12",md:"9"},{default:a(()=>[e(Re,{modelValue:p(k),"onUpdate:modelValue":l[2]||(l[2]=s=>P(k)?k.value=s:null),"prepend-inner-icon":"ri-chat-4-line",placeholder:"Enter Remark for Buyer",rules:[p(Ie)]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(C,{"offset-md":"3",cols:"12",md:"9",class:"d-flex gap-4"},{default:a(()=>[e(j,{class:"ml-8",color:"secondary",onClick:l[3]||(l[3]=s=>V.value=!1),variant:"tonal"},{default:a(()=>[r(" Close ")]),_:1}),e(j,{type:"submit",onClick:l[4]||(l[4]=s=>o.$refs.refForm.validate().then(()=>c()))},{default:a(()=>[r(" Send ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(de,{modelValue:p(x),"onUpdate:modelValue":l[7]||(l[7]=s=>P(x)?x.value=s:null),location:"top end",transition:"scale-transition",color:"success"},{default:a(()=>[e(d,{size:"20",class:"me-2"},{default:a(()=>[r("ri-checkbox-circle-line")]),_:1}),r(" Order has been successfully approved. ")]),_:1},8,["modelValue"]),e(de,{modelValue:p(i),"onUpdate:modelValue":l[8]||(l[8]=s=>P(i)?i.value=s:null),location:"top end",transition:"scale-transition",color:"success"},{default:a(()=>[e(d,{size:"20",class:"me-2"},{default:a(()=>[r("ri-checkbox-circle-line")]),_:1}),r(" Order has been successfully rejected. ")]),_:1},8,["modelValue"])],64))}},Pa=ce(wa,[["__scopeId","data-v-9a9ab753"]]),Ra={style:{display:"flex","align-items":"center"}},Ma={__name:"export-item",props:{passStatus:{type:Object,default:null},passOrderDateRange:{type:Array,default:null},passMeetDateRange:{type:Array,default:null},passSearch:{type:String,default:null}},setup(b){const f=b,{passOrderDateRange:w}=_e(f),{passMeetDateRange:h}=_e(f),g=v([]),V=v([{id:1,title:"PDF",value:"PDF",icon:"ri-file-pdf-line"},{id:2,title:"Excel",value:"Excel",icon:"ri-file-excel-2-line"},{id:3,title:"CSV",value:"CSV",icon:"ri-file-text-line"},{id:4,title:"Print",value:"Print",icon:"ri-printer-line"}]),$=v(null),k=Me,R=()=>{const n=new Ae,c=g.value.map(y=>[y.id,y.order_dateTime,y.user.username,y.item.name,y.meet_dateTime,y.place_to_meet,y.quantity,y.approximated_price,y.rating,y.status]),o=new Date,l=`${o.getFullYear()}/${o.getMonth()+1}/${o.getDate()} ${o.getHours()}:${("0"+o.getMinutes()).slice(-2)}:${("0"+o.getSeconds()).slice(-2)}`;let s=n.internal.pageSize.getWidth(),u=30,T=s/2-u/2;n.addImage(k,"PNG",T,12,u,u),n.setFontSize(18),n.text("Report of Sales Items",14,50),n.setFontSize(10),n.setTextColor(128),n.text(`Export Date: ${l}`,14,58),n.autoTable({theme:"grid",head:[["Order ID","Order Date","Buyer","Item","Meet Date","Place to Meet","Quantity","Approximated Price","Rating","Status"]],body:c,styles:{fillColor:[255,255,255],textColor:20,fontSize:10},headStyles:{fillColor:[93,123,234],textColor:255,fontSize:10},margin:{top:65},startY:65}),n.save("SalesItems.pdf")},D=()=>{const n=g.value.map(l=>({"Order ID":l.id,"Order Date":l.order_dateTime,Buyer:l.user.username,Item:l.item.name,"Meet Date":l.meet_dateTime,"Place to Meet":l.place_to_meet,Quantity:l.quantity,"Approximated Price":l.approximated_price,Rating:l.rating,Status:l.status})),c=oe.json_to_sheet(n),o=oe.book_new();oe.book_append_sheet(o,c,"Sheet1"),Ee(o,"SalesItems.xlsx")},x=()=>{const n=g.value.map(u=>({"Order ID":u.id,"Order Date":u.order_dateTime,Buyer:u.user.username,Item:u.item.name,"Meet Date":u.meet_dateTime,"Place to Meet":u.place_to_meet,Quantity:u.quantity,"Approximated Price":u.approximated_price,Rating:u.rating,Status:u.status})),c=Fe.unparse(n),o=new Blob([c],{type:"text/csv;charset=utf-8"}),l=URL.createObjectURL(o),s=document.createElement("a");s.href=l,s.download="SalesItems.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s)},i=be(()=>{const n=g.value.map(l=>({"Order ID":l.id,"Order Date":l.order_dateTime,Buyer:l.user.username,Item:l.item.name,"Meet Date":l.meet_dateTime,"Place to Meet":l.place_to_meet,Quantity:l.quantity,"Approximated Price":l.approximated_price,Rating:l.rating,Status:l.status})),c=`<tr>${Object.keys(n[0]).map(l=>`<th style="text-align: left">${l}</th>`).join("")}</tr>`,o=n.map(l=>`<tr>${Object.values(l).map(s=>`<td>${s}</td>`).join("")}</tr>`).join("");return`<table><thead>${c}</thead><tbody>${o}</tbody></table>`}),q=()=>{const n=window.open("","","height=400,width=800");n.document.write(`<html><head><style>table {border-collapse: collapse; widh: 100%} td,th {border: 1px solid #dddddd; text align:left; padding: 8px;} th {background-color: #f2f2f2;}</style></head><body>${i.value}</body></html>`),n.document.close(),n.focus(),n.print(),n.close()},U=n=>{const c=n.getDate().toString().padStart(2,"0"),o=(n.getMonth()+1).toString().padStart(2,"0"),l=n.getFullYear();return`${c}-${o}-${l}`},B=ze(()=>{let n="/api/order-items/get-confirmed-sell-orders";const c=(l,s)=>{s&&(n+=n.includes("?")?`&${l}=${s}`:`?${l}=${s}`)};c("search",f.passSearch&&f.passSearch.length>2?f.passSearch:null),c("status",f.passStatus.value||null);const o=(l,s)=>{if(!s)return;const u=U(s[0]),T=U(s[1]);c(l,`${u} - ${T}`)};o("order_date",w.value),o("meet_date",h.value),X.get(n).then(({data:l})=>{g.value=l.data,g.value.forEach(s=>{const u=T=>{const y=new Date(T),A=y.getFullYear(),H=String(y.getMonth()+1).padStart(2,"0"),G=String(y.getDate()).padStart(2,"0");let E=y.getHours();const se=String(y.getMinutes()).padStart(2,"0"),le=E>=12?"pm":"am";return E=E%12||12,`${A}-${H}-${G} ${E}:${se} ${le}`};s.order_dateTime=u(s.order_dateTime),s.meet_dateTime=u(s.meet_dateTime)}),g.value.forEach(s=>{s.item.pictures.forEach(u=>{u.picture_path="/storage/"+u.picture_path})}),g.value.forEach(s=>{(s.status==="Rejected"||s.status==="Cancelled")&&(s.meet_dateTime="null")}),g.value.forEach(s=>{s.rating===null&&(s.rating="null")}),$.value==="Print"?q():$.value==="PDF"?R():$.value==="Excel"?D():$.value==="CSV"&&x()}).catch(l=>{console.log(l)})},800),N=n=>{$.value=n,B()};return(n,c)=>(_(),S(je,{"open-on-hover":""},{activator:a(({props:o})=>[e(j,Ve(o,{"prepend-icon":"ri-download-2-line"}),{default:a(()=>[r(" Export ")]),_:2},1040)]),default:a(()=>[e(De,null,{default:a(()=>[(_(!0),I(L,null,K(V.value,o=>(_(),S(ke,{key:o.value,onClick:l=>N(o.value)},{default:a(()=>[t("div",Ra,[e(d,{icon:o.icon,size:"16px",style:{"margin-inline-end":"5px"}},null,8,["icon"]),r(" "+m(o.title),1)])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}))}},ae=b=>(ue("data-v-41816b25"),b=b(),pe(),b),za={class:"box-style"},Aa=ae(()=>t("span",null,"Order of Selling Items",-1)),Ea=ae(()=>t("p",null,[r(" This page displays pending and confirmed orders. Click ‘View’ to see order details. "),t("strong",null,"Grey color Order ID indicates orders past their meet_dateTime for Confirmed Orders.")],-1)),Fa=ae(()=>t("span",null,"Pending Order",-1)),ja=ae(()=>t("span",null,"Confirmed Order",-1)),Ua={class:"table-style"},Ba={class:"table-style"},qa={__name:"sales-items",setup(b){const f=v([]),w=v([]),h=v("tab-1"),g=v(""),V=v([]),$=v(null),k=v(null),R=v(null),D=v(null),x=v(null),i=v(null),q=[{name:"Approved",value:"Approved"},{name:"Rejected",value:"Rejected"},{name:"Cancelled",value:"Cancelled"}],U=()=>{X.get("/api/order-items/get-pending-sell-orders").then(n=>{f.value=n.data.data,f.value.forEach(c=>{const o=l=>{const s=new Date(l),u=s.getFullYear(),T=String(s.getMonth()+1).padStart(2,"0"),y=String(s.getDate()).padStart(2,"0");let A=s.getHours();const H=String(s.getMinutes()).padStart(2,"0"),G=A>=12?"pm":"am";return A=A%12||12,`${u}-${T}-${y} ${A}:${H} ${G}`};c.order_dateTime=o(c.order_dateTime),c.meet_dateTime=o(c.meet_dateTime)}),f.value.forEach(c=>{c.item.pictures.forEach(o=>{o.picture_path="/storage/"+o.picture_path})})}).catch(n=>{console.log(n)})},B=n=>{const c=n.getDate().toString().padStart(2,"0"),o=(n.getMonth()+1).toString().padStart(2,"0"),l=n.getFullYear();return`${c}-${o}-${l}`},N=Ue.debounce(()=>{let n="/api/order-items/get-confirmed-sell-orders";const c=(l,s)=>{s&&(n+=n.includes("?")?`&${l}=${s}`:`?${l}=${s}`)};c("search",g.value&&g.value.length>2?g.value:null),c("status",V.value.value||null);const o=(l,s)=>{if(!s)return;const u=B(s[0]),T=B(s[1]);c(l,`${u} - ${T}`)};o("order_date",$.value),o("meet_date",k.value),X.get(n).then(({data:l})=>{w.value=l.data,w.value.forEach(s=>{const u=T=>{const y=new Date(T),A=y.getFullYear(),H=String(y.getMonth()+1).padStart(2,"0"),G=String(y.getDate()).padStart(2,"0");let E=y.getHours();const se=String(y.getMinutes()).padStart(2,"0"),le=E>=12?"pm":"am";return E=E%12||12,`${A}-${H}-${G} ${E}:${se} ${le}`};s.order_dateTime=u(s.order_dateTime),s.meet_dateTime=u(s.meet_dateTime)}),w.value.forEach(s=>{s.item.pictures.forEach(u=>{u.picture_path="/storage/"+u.picture_path})})}).catch(l=>{console.log(l)})},800);return Se([g,V,$,k,h],()=>{N(),R.value=V.value,D.value=$.value,x.value=k.value,i.value=g.value}),U(),N(),(n,c)=>(_(),I("div",za,[e(me,{variant:"tonal",color:"info"},{title:a(()=>[e(d,{icon:"ri-information-line",class:"mr-2"}),Aa]),default:a(()=>[Ea]),_:1}),e(Be,{modelValue:p(h),"onUpdate:modelValue":c[0]||(c[0]=o=>P(h)?h.value=o:null),grow:"",stacked:""},{default:a(()=>[e(he,{value:"tab-1"},{default:a(()=>[e(d,{icon:"ri-loader-line",class:"mb-2"}),Fa]),_:1}),e(he,{value:"tab-2"},{default:a(()=>[e(d,{icon:"ri-takeaway-line",class:"mb-2"}),ja]),_:1})]),_:1},8,["modelValue"]),e(qe,{modelValue:p(h),"onUpdate:modelValue":c[6]||(c[6]=o=>P(h)?h.value=o:null),class:"mt-5"},{default:a(()=>[e(ve,{value:"tab-1"},{default:a(()=>[t("div",Ua,[e(Pa,{pendingOrders:p(f),getPendingOrders:U},null,8,["pendingOrders"])])]),_:1}),e(ve,{value:"tab-2"},{default:a(()=>[e(Z,{class:"ml-2 mr-2 mt-1"},{default:a(()=>[r(" Filter Confirmed Orders")]),_:1}),e(Ce,{class:"ml-2 mr-2 mb-2"},{default:a(()=>[r(" Filter confirmed orders by order status, order date, meet date and search for buyer and item.")]),_:1}),e(W,{class:"ml-2 mr-2"},{default:a(()=>[e(C,{cols:"12",md:"4"},{default:a(()=>[e(ye,{modelValue:p(V),"onUpdate:modelValue":c[1]||(c[1]=o=>P(V)?V.value=o:null),chips:"","return-object":"","item-title":"name",items:q,"prepend-inner-icon":"ri-filter-3-line",placeholder:"Select Order Status",clearable:"",density:"compact","onClick:clear":c[2]||(c[2]=o=>V.value=[])},null,8,["modelValue"])]),_:1}),e(C,{cols:"12",md:"4"},{default:a(()=>[e(p(fe),{"teleport-center":"",clearable:!0,modelValue:p($),"onUpdate:modelValue":c[3]||(c[3]=o=>P($)?$.value=o:null),placeholder:"Select Date Range (Order Date)","enable-time-picker":!1,format:"dd/MM/yyyy",range:"",class:"mt-2"},null,8,["modelValue"])]),_:1}),e(C,{cols:"12",md:"4"},{default:a(()=>[e(p(fe),{"teleport-center":"",clearable:!0,modelValue:p(k),"onUpdate:modelValue":c[4]||(c[4]=o=>P(k)?k.value=o:null),placeholder:"Select Date Range (Meet Date)","enable-time-picker":!1,format:"dd/MM/yyyy",range:"",class:"mt-2"},null,8,["modelValue"])]),_:1})]),_:1}),e(W,{class:"ml-2 mr-2"},{default:a(()=>[e(C,{cols:"12",md:"4"},{default:a(()=>[e(Ma,{passStatus:p(R),passOrderDateRange:p(D),passMeetDateRange:p(x),passSearch:p(i)},null,8,["passStatus","passOrderDateRange","passMeetDateRange","passSearch"])]),_:1}),e(C,{cols:"12",md:"4"}),e(C,{cols:"12",md:"4"},{default:a(()=>[e(Ne,{class:"mb-4",modelValue:p(g),"onUpdate:modelValue":c[5]||(c[5]=o=>P(g)?g.value=o:null),label:"Search Buyer and Item",placeholder:"Search for customer and item",dense:"",density:"compact",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t("div",Ba,[e(Qt,{confirmedOrders:p(w),getConfirmedOrders:p(N)},null,8,["confirmedOrders","getConfirmedOrders"])])]),_:1})]),_:1},8,["modelValue"])]))}},vs=ce(qa,[["__scopeId","data-v-41816b25"]]);export{vs as default};
